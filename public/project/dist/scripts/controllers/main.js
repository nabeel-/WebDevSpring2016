"use strict";angular.module("TutorConnect").controller("MainCtrl",function($rootScope,$state,TutorService,ClassesService){var vm=this;vm.classNames=["Math","Science","History","English","Spanish","French"],vm.myClassNames=[],vm.nextBlock={},vm.my=$rootScope.currentUser,vm.isTutor="tutor"===vm.my.roles[0],vm.my.tutor=vm.my.classes=null,vm.isTutor?TutorService.getTutorFromUserId(vm.my._id).then(function(resp){200===resp.status&&resp.data&&(vm.my.tutor=resp.data,TutorService.getSubjectsForTutor(vm.my.tutor._id).then(function(resp){200===resp.status&&resp.data&&(vm.my.subjects=resp.data.subjects)}),ClassesService.getClassesForTutor(vm.my._id,vm.my.tutor._id).then(function(resp){200===resp.status&&resp.data&&(vm.nextBlock.date=resp.data[0].startTime.split(" ")[0])}))}):ClassesService.getAllClassesForUser(vm.my._id).then(function(resp){200===resp.status&&resp.data&&(vm.nextBlock.date=resp.data[0].startTime.split(" ")[0])}),vm.toggle=function(className){var idx=vm.myClassNames.indexOf(className);idx>-1?vm.myClassNames.splice(idx,1):vm.myClassNames.push(className)},vm.createTutor=function(){var tutor={subjects:vm.myClassNames};TutorService.createTutorWithUser(vm.my._id,tutor).then(function(resp){200===resp.status&&$state.go("dashboard.home")})}});